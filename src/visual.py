import time

import cv2
import numpy as np

drone_last_pos = (0, 0)
map = np.full((1000, 1000, 3), 255, dtype='uint8')
map_data = np.zeros((1000, 1000))

xsize, ysize = map_data.shape

brum = [[372, 176], [372, 176], [371, 176], [379, 176], [448, 176], [453, 176], [461, 176], [461, 177], [481, 177], [483, 178], [485, 178], [488, 179], [488, 179], [490, 179], [491, 179], [491, -179], [493, -179], [493, -179], [494, -178], [496, -178], [496, -178], [497, -177], [498, -177], [499, -177], [500, -177], [502, -177], [504, -176], [507, -176], [506, -176], [506, -175], [508, -175], [513, -175], [518, -174], [519, -174], [519, -173], [520, -173], [528, -172], [528, -172], [530, -172], [537, -171], [537, -171], [540, -170], [541, -170], [546, -169], [546, -169], [548, -169], [553, -168], [552, -168], [553, -167], [554, -167], [554, -166], [554, -166], [534, -166], [529, -165], [528, -164], [526, -164], [513, -164], [513, -163], [508, -163], [508, -163], [506, -163], [503, -162], [498, -162], [495, -162], [487, -161], [486, -161], [486, -161], [485, -160], [485, -160], [473, -160], [469, -159], [466, -159], [463, -159], [462, -158], [460, -158], [459, -157], [449, -157], [449, -157], [448, -156], [448, -156], [438, -155], [438, -155], [435, -155], [434, -154], [434, -154], [430, -154], [430, -153], [431, -153], [431, -153], [436, -152], [438, -152], [439, -152], [439, -152], [439, -152], [437, -152], [437, -152], [437, -152], [436, -152], [433, -152], [433, -152], [433, -152], [433, -152], [432, -152], [432, -152], [431, -152], [431, -152], [431, -152], [431, -152], [432, -152], [434, -152], [434, -152], [435, -151], [436, -151], [436, -151], [437, -151], [437, -151], [439, -151], [445, -151], [447, -150], [448, -150], [451, -150], [454, -150], [455, -149], [458, -149], [463, -149], [464, -149], [465, -149], [467, -148], [468, -148], [468, -148], [468, -148], [468, -148], [467, -148], [467, -147], [467, -147], [467, -147], [468, -147], [472, -147], [472, -146], [475, -146], [475, -146], [476, -146], [476, -146], [519, -146], [519, -145], [520, -145], [530, -145], [530, -145], [530, -145], [530, -144], [529, -144], [531, -144], [528, -144], [528, -143], [524, -143], [526, -143], [526, -142], [526, -142], [508, -142], [502, -141], [491, -141], [491, -140], [490, -140], [497, -139], [523, -139], [546, -139], [666, -138], [666, -137], [672, -137], [688, -136], [688, -136], [699, -135], [705, -134], [730, -134], [826, -133], [1276, -133], [1276, -132], [1276, -131], [1273, -131], [348, -130], [461, -129], [464, -129], [464, -127], [463, -126], [462, -126], [461, -125], [423, -125], [399, -124], [391, -123], [350, -123], [350, -122], [380, -122], [417, -121], [430, -121], [438, -120], [451, -120], [450, -119], [52674, -119], [449, -118], [448, -117], [448, -117], [447, -116], [447, -116], [447, -115], [446, -115], [446, -114], [446, -114], [447, -113], [446, -113], [446, -112], [446, -112], [446, -111], [446, -111], [446, -111], [446, -111], [446, -111], [445, -110], [445, -110], [446, -110], [445, -110], [435, -110], [939, -109], [424, -109], [381, -109], [378, -108], [375, -108], [371, -108], [369, -107], [369, -107], [367, -107], [357, -107], [356, -106], [350, -105], [350, -105], [351, -104], [349, -104], [348, -104], [347, -104], [347, -103], [342, -103], [341, -103], [340, -102], [339, -102], [338, -102], [336, -102], [336, -102], [336, -102], [335, -101], [335, -101], [334, -101], [335, -101], [344, -100], [353, -100], [392, -99], [392, -99], [408, -99], [429, -98], [457, -98], [457, -98], [458, -98], [457, -97], [455, -97], [453, -97], [453, -97], [453, -97], [441, -96], [441, -96], [436, -96], [435, -96], [423, -96], [416, -95], [411, -95], [411, -95], [385, -94], [385, -94], [375, -93], [372, -93], [371, -93], [348, -92], [348, -92], [345, -91], [339, -91], [329, -91], [329, -91], [317, -90], [317, -90], [311, -90], [308, -89], [308, -89], [305, -89], [289, -88], [289, -88], [286, -87], [284, -87], [279, -87], [273, -86], [273, -86], [270, -86], [268, -85], [266, -85], [256, -84], [256, -84], [256, -83], [254, -83], [253, -82], [236, -82], [235, -81], [231, -80], [227, -80], [226, -79], [213, -78], [213, -78], [212, -77], [210, -76], [210, -75], [209, -74], [190, -73], [189, -72], [183, -72], [179, -71], [179, -70], [175, -69], [175, -69], [173, -68], [172, -68], [170, -67], [170, -66], [168, -66], [162, -65], [161, -64], [157, -64], [157, -63], [156, -62], [153, -61], [153, -60], [149, -59], [147, -59], [146, -58], [145, -57], [141, -56], [141, -55], [141, -54], [138, -53], [138, -52], [135, -52], [135, -51], [135, -49], [134, -48], [131, -48], [131, -47], [130, -46], [129, -45], [129, -45], [129, -44], [128, -44], [128, -43], [128, -43], [128, -42], [128, -42], [128, -41], [128, -41], [128, -41], [128, -40], [128, -39], [127, -39], [127, -38], [127, -37], [127, -37], [127, -36], [127, -36], [127, -35], [127, -35], [127, -34], [127, -34], [127, -34], [127, -33], [127, -33], [127, -32], [127, -31], [127, -31], [126, -30], [126, -30], [126, -29], [127, -28], [127, -27], [127, -27], [127, -26], [127, -25], [127, -24], [127, -24], [127, -23], [127, -22], [128, -21], [127, -21], [128, -20], [128, -19], [128, -19], [128, -19], [128, -18], [128, -18], [128, -17], [129, -17], [129, -16], [129, -16], [129, -15], [129, -15], [129, -14], [130, -13], [130, -13], [130, -12], [130, -12], [131, -12], [131, -11], [131, -11], [132, -10], [132, -10], [132, -9], [132, -9], [132, -9], [133, -9], [133, -9], [133, -9], [133, -9], [133, -10], [133, -10], [133, -10], [133, -10], [133, -10], [133, -11], [133, -11], [133, -11], [133, -11], [133, -11], [133, -12], [133, -12], [133, -12], [133, -12], [133, -12], [133, -12], [133, -12], [133, -12], [133, -12], [133, -12], [133, -12], [132, -12], [133, -13], [132, -13], [133, -13], [133, -14], [133, -14], [133, -14], [132, -14], [132, -14], [132, -14], [132, -14], [132, -13], [132, -13], [133, -12], [133, -12], [133, -11], [132, -11], [132, -11], [132, -11], [132, -11], [132, -11], [131, -11], [131, -11], [131, -11], [131, -11], [131, -11], [131, -11], [131, -11], [131, -11], [130, -11], [130, -11], [130, -12], [130, -12], [130, -12], [130, -12], [130, -12], [130, -12], [131, -12], [131, -12], [131, -12], [131, -12], [131, -12], [131, -12], [131, -12], [131, -12], [131, -12], [132, -12], [131, -11], [131, -11], [131, -11], [132, -11], [132, -11], [132, -10], [131, -10], [132, -10], [132, -10], [132, -9], [132, -9], [133, -9], [133, -9], [133, -8], [133, -8], [134, -7], [134, -7], [135, -7], [135, -6], [135, -6], [135, -5], [135, -5], [137, -4], [137, -3], [138, -3], [138, -2], [137, -1], [138, 0], [138, 0], [138, 0], [140, 1], [141, 2], [142, 3], [144, 3], [176, 4], [145, 5], [145, 6], [145, 7], [149, 7], [150, 8], [150, 9], [151, 10], [155, 11], [156, 11], [159, 12], [159, 12], [163, 13], [163, 14], [164, 14], [163, 15], [165, 16], [168, 16], [169, 17], [175, 17], [175, 18], [175, 19], [175, 19], [177, 19], [181, 20], [181, 20], [182, 21], [182, 21], [182, 22], [191, 22], [195, 23], [195, 24], [199, 25], [200, 25], [201, 26], [218, 26], [218, 28], [219, 29], [223, 29], [226, 30], [227, 31], [227, 32], [223, 32], [219, 33], [216, 34], [215, 35], [212, 35], [212, 36], [208, 37], [208, 38], [207, 39], [206, 39], [203, 40], [201, 41], [201, 41], [200, 42], [200, 42], [198, 43], [197, 43], [196, 43], [196, 44], [196, 44], [195, 44], [195, 44], [195, 43], [196, 43], [196, 43], [196, 42], [196, 42], [196, 42], [197, 42], [198, 41], [198, 41], [198, 41], [198, 41], [198, 41], [198, 41], [198, 42], [198, 42], [198, 42], [198, 42], [197, 43], [197, 43], [197, 43], [196, 43], [196, 44], [196, 44], [195, 44], [194, 45], [193, 45], [193, 45], [193, 46], [193, 46], [193, 46], [193, 47], [191, 47], [190, 48], [189, 48], [189, 49], [189, 49], [187, 50], [185, 50], [182, 51], [182, 52], [182, 52], [181, 53], [179, 53], [179, 54], [179, 54], [179, 55], [179, 56], [179, 56], [175, 57], [175, 57], [175, 57], [175, 57], [175, 57], [176, 57], [176, 56], [176, 56], [177, 55], [178, 54], [178, 53], [179, 53], [179, 52], [181, 52], [181, 52], [181, 51], [181, 51], [182, 51], [183, 52], [183, 53], [183, 54], [183, 54], [182, 55], [182, 56], [182, 57], [182, 58], [182, 59], [182, 59], [182, 60], [182, 61], [182, 61], [182, 62], [182, 62], [181, 62], [181, 63], [181, 63], [181, 63], [181, 63], [181, 64], [180, 64], [180, 65], [179, 65], [179, 65], [178, 66], [178, 66], [178, 66], [177, 67], [177, 67], [176, 68], [176, 69], [176, 70], [176, 71], [176, 72], [176, 73], [176, 74], [176, 74], [176, 75], [176, 77], [176, 78], [178, 79], [178, 80], [179, 81], [180, 82], [181, 83], [181, 84], [181, 84], [184, 85], [184, 86], [185, 86], [186, 87], [186, 87], [186, 87], [187, 88], [187, 88], [188, 88], [189, 89], [190, 89], [190, 89], [191, 89], [191, 89], [192, 89], [192, 90], [192, 90], [192, 90], [193, 90], [193, 90], [193, 90], [194, 91], [194, 91], [195, 91], [194, 91], [198, 92], [198, 92], [197, 92], [199, 93], [199, 93], [200, 93], [200, 93], [201, 93], [201, 93], [201, 93], [201, 93], [201, 93], [202, 93], [202, 93], [202, 93], [202, 93], [202, 93], [202, 93], [202, 93], [201, 93], [201, 93], [202, 93], [202, 93], [203, 93], [204, 94], [204, 94], [205, 94], [205, 94], [205, 94], [206, 95], [207, 95], [208, 95], [208, 95], [208, 96], [209, 96], [209, 96], [210, 96], [210, 96], [210, 97], [210, 97], [210, 97], [210, 97], [210, 97], [210, 97], [210, 97], [209, 97], [209, 97], [209, 97], [208, 97], [208, 97], [208, 97], [208, 97], [207, 97], [208, 97], [206, 97], [206, 97], [206, 97], [206, 98], [205, 98], [205, 98], [204, 98], [204, 98], [204, 98], [204, 98], [204, 98], [204, 98], [204, 98], [204, 98], [204, 99], [205, 99], [205, 99], [206, 99], [207, 100], [208, 100], [210, 101], [210, 101], [213, 102], [215, 103], [216, 103], [217, 104], [218, 105], [218, 105], [221, 105], [221, 106], [221, 106], [222, 106], [223, 106], [224, 106], [224, 106], [224, 106], [224, 106], [223, 106], [222, 106], [222, 106], [219, 106], [218, 105], [218, 105], [216, 105], [215, 104], [215, 104], [213, 103], [213, 103], [208, 102], [198, 98], [192, 94], [192, 89], [187, 83], [185, 75], [170, 66], [172, 54], [199, 40], [203, 24], [125, 5], [125, -14], [131, -36], [150, -58], [159, -81], [473, -127], [479, -150], [516, -172], [497, 168], [451, 153], [449, 141], [399, 134], [399, 130], [396, 131], [395, 136], [412, 143], [355, 153], [355, 178]]

print(len(brum))


def map_init():
    global map, map_data

    map_data = np.zeros((xsize, ysize))

    map = np.full((xsize, ysize, 3), 255, dtype='uint8')

    map = cv2.line(map, (round(xsize/2-20), round(ysize/2-20)), (round(xsize/2+20), round(ysize/2+20)), (0, 255, 0), 2)
    map = cv2.line(map, (round(xsize/2+20), round(ysize/2-20)), (round(xsize/2-20), round(ysize/2+20)), (0, 255, 0), 2)
    # draw drone position (in center)
    pass


def update_map(dist, curr_angle):
    global map, map_data

    xpos = np.cos(-curr_angle/180*np.pi)*dist/2 + xsize/2
    ypos = np.sin(-curr_angle/180*np.pi)*dist/2 + ysize/2

    try:
        map_data[round(xpos), round(ypos)] = 1
        map = cv2.circle(map, (round(ypos), round(xpos)), 1, (0, 0, 0), 2)
    except IndexError as e:
        print(e)

    cv2.imshow("Brum...", map_data)
    cv2.imshow("Brumik.", map)

    pass


if __name__ == "__main__":
    map_init()
    for i in brum:
        update_map(*i)
        if cv2.waitKey(1) & 0xFF == ord('q'):
            break
    while not cv2.waitKey(0) & 0xFF == ord('q'):
        pass

